<!DOCTYPE html>
<meta charset="utf-8">
<style>
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  width: 960px;
  height: 500px;
  position: relative;
}
path.slice{
	stroke-width:2px;
}
polyline{
	opacity: .3;
	stroke: black;
	stroke-width: 2px;
	fill: none;
} 
svg text.percent{
	fill:white;
	text-anchor:middle;
	font-size:12px;
}

</style>
<body>
    <form>
        <label><input type="radio" name="dataset" value="revenue" onclick="changeData(0);"> Revenue</label>
        <label><input type="radio" name="dataset" value="tuition02_tf" onclick="changeData(1);"> Tuition</label>
        <label><input type="radio" name="dataset" value="inst_grant_avg" onclick="changeData(2);" checked> Average University Grants</label>
        <label><input type="radio" name="dataset" value="fed_grant_avg_amount" onclick="changeData(3);"> Average Federal Grants</label>
        <label><input type="radio" name="dataset" value="state_grant_avg_amount" onclick="changeData(4);"> Average State Grants</label>
        <label><input type="radio" name="dataset" value="loan_avg_amount" onclick="changeData(5);"> Average Loan Amount</label>
    </form>
<script src="../javascripts/d3.min.js"></script>
<script src="../javascripts/piechart.js"></script>
<script>

var colors=[
	{color:"#DF0101"},
	{color:"#F0E400"},
	{color:"#848484"},
	{color:"#01DF01"},
	{color:"#2E9AFE"}
];

var svg = d3.select("body")
            .append("svg")
            .attr("width",700)
            .attr("height",300);

svg.append("g").attr("id","pieChart");

var dataset = {};
setUpData();

function changeData(value){
        var choice;
        if(value == 0) {
            choice = "revenue";
        }
        else if(value == 1) {
            choice = "tuition02_tf"
        }
        else if(value == 2) {
            choice = "inst_grant_avg"
        }
        else if(value == 3) {
            choice = "fed_grant_avg_amount";
        }
        else if(value == 4) {
            choice = "state_grant_avg_amount";
        }
        else {
            choice = "loan_avg_amount";
        }
	PieChart.transition("pieChart", dataset, choice, 130, 100, 30, 0.3);
}

function setUpData(){
    if (dataset.length > 0) {
        callback(null, parse(variable, dataset)); 
    }
    else {
        d3.csv("../data/top5Grants.csv", function(error, data) {
            var i = 0;
            data.map(function(d) {
                d.tuition02_tf = +d.tuition02_tf;
                d.revenue = +d.revenue;
                d.control = +d.control;
                d.total_enrollment = +d.total_enrollment;
                d.fed_grant_avg_amount = +d.fed_grant_avg_amount;
                d.state_grant_avg_amount = +d.state_grant_avg_amount;
                d.loan_avg_amount = +d.loan_avg_amount;
                d.inst_grant_avg = +d.inst_grant_avg;
                d.color = colors[i].color;
                d.label = colors[i].label;
                i++;
            });
            dataset = data;
            PieChart.draw("pieChart", dataset, 'inst_grant_avg', 150, 150, 130, 100, 30, 0.3);
        });
    }
}

</script>
</body>